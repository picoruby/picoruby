module Funicular
  class Component
    type props_t = Hash[Symbol, Symbol | Proc]

    HTML_TAGS: Array[String]

    attr_reader state: Hash[Symbol, untyped]
    attr_reader props: props_t
    attr_reader refs: Hash[Symbol, JS::Object]

    def self.new: (?props_t props) -> Component
    def initialize_state: () -> Hash[Symbol, untyped]
    def update: (Hash[Symbol, untyped] new_state) -> void
    def mount: (JS::Object container) -> void
    def unmount: () -> void
    def render: () -> (VDOM::VNode | String | Integer | Float | Array[untyped])

    private def re_render: () -> void

    private def build_vdom: () -> VDOM::VNode
    private def normalize_vnode: (untyped value) -> VDOM::VNode
    private def bind_events: (JS::Object dom_element, VDOM::VNode vnode) -> void
    private def create_event_handler: (Symbol | Proc handler_value) -> Proc
    private def collect_refs: (JS::Object dom_element, VDOM::VNode vnode, ?Hash[Symbol, JS::Object] refs_map) -> Hash[Symbol, JS::Object]
    private def cleanup_events: () -> void
    private def add_child: (untyped child) -> void

    # HTML element methods
    private def div: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def span: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def p: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def a: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def h1: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def h2: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def h3: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def h4: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def h5: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def h6: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def ul: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def ol: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def li: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def table: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def thead: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def tbody: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def tr: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def th: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def td: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def form: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def input: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def textarea: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def button: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def select: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def option: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def header: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def footer: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def nav: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def section: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def article: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def aside: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def img: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def video: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def audio: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def br: (?props_t props) ?{ -> untyped } -> VDOM::Element
    private def hr: (?props_t props) ?{ -> untyped } -> VDOM::Element

    # Lifecycle hooks (optional, can be overridden in subclasses)
    private def component_will_mount: () -> void
    private def component_mounted: () -> void
    private def component_will_update: () -> void
    private def component_updated: () -> void
    private def component_will_unmount: () -> void
    private def component_unmounted: () -> void
    private def component_raised: (Exception e) -> void
  end
end
